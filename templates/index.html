<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>

  <head>
          <meta charset="utf-8">
          <title>Dojo Timeline</title>


        <!-- #FIXME Messes up the dojoTimeLine css .....-->
        <link type="text/css" rel="stylesheet" href="static/scripts/lib/dojo1.8.3/dojo/resources/dojo.css"/>
        <link type="text/css" rel="stylesheet" href="static/scripts/lib/dojo1.8.3/dijit/themes/claro/claro.css"/>


        <style type="text/css">

          html, body{
            width       : 100%;
            height      : 100%;
            margin      : 0;
            padding     : 0;
            font-family : Helvetica,Sans-serif,Tahoma,Ubuntu;
          }

          #dojoTimeLineWidgetContainer,
          #dojoTimeLine{
            border        : solid 1px navy;
            border-radius : 3px;
            background    : white;
            width         : 85%;
            height    : 10em;
            overflow-y    : hidden;
            overflow-x    : auto;
            cursor        : pointer;
            margin-bottom : 2%;
            margin-left   : 2%;
          }

          #dojoTimeLineWidget_0{
            background    : white;
            height    : 10em;
            overflow-y    : hidden;
            overflow-x    : auto;
            cursor        : pointer;
          }

       
         #appContainer{
           position: absolute;
           top     : 0;
           width   : 100%;
           height  : 100%;
           margin   : 0; 
          }

          #dojoTimeLineWidgetContainer{
            position      : relative;
            top           : 5%;
            left          : 5%;            
          }

        </style>

          <script type="text/javascript">
              var dojoConfig= {
                  parseOnLoad      : true,
                  async            : true,
                  baseUrl          : "./static/scripts/",
                  tlmSiblingOfDojo : false ,
                  executeScripts   : true  , 
                  isDebug          : true  ,
                  packages: [
                      { name: "dojo"         , location: "lib/dojo1.8.3/dojo" },
                      { name: "dijit"        , location: "lib/dojo1.8.3/dijit" },
                      { name: "dojox"        , location: "lib/dojo1.8.3/dojox" },
                      { name: "dojoTimeLine" , location: "custom" , main: "dojoTimeLineWidget" }
                  ]
              };
          </script>

          <script src              = "static/scripts/lib/dojo1.8.3/dojo/dojo.js"
                  type             = "text/javascript">
          </script>

          <script type="text/javascript">
              require([
                       "dojoTimeLine/dojoTimeLineWidget", 
                       "dojo/parser", 
                       "dojo/dom",
                       "dojo/on",
                       "dojo/json",
                       "dojo/request",
                       "dojo/dom-form",
                       "dojo/dom-attr",

                       "dijit/layout/BorderContainer", 
                       "dijit/layout/TabContainer", 
                       "dijit/layout/AccordionContainer", 
                       "dijit/layout/ContentPane", 
                       "dijit/layout/AccordionPane",
                        

                       'dojo/domReady!'],
              function(dojoTimeLineWidget, parser, dom,on,JSON, request, domForm, domAttr){

                //Runs the dojoTimeLine....
                console.log(dojoTimeLineWidget);

                on(dom.byId('addEventForm'), 'submit',function(e){
                   e.preventDefault();
                   var formObj  = e.target;
                   var formPost = domForm.toObject(formObj);
                   var urlToPost = domAttr.get(formObj,'action');
                   request.post(urlToPost,{data: formPost}).
                   then(function(json){ 
                           alert("Good");
                           var jsondata = JSON.parse(json);
                           console.log(jsondata);
                           return false;
                        }, 
                        function(err){ 
                           alert("Bad"); 
                           return false;
                        }
                   );
                   console.log(formPost);
//                   e.preventDefault();
//                   alert("form submission will work soon ! ");
                   return false;
                });
                
              });
          </script>

  </head>

  <body id="claro">
    <!-- 
    
    #FIXME
    
    Messes up the CSS of the dojoTimeLine div and innner divs... 
    Needs a better solution if this dosent display well inside of a Dijit Layout. 
    
    Incase this works, put the dojoTimeLine DIV inside the dojoTimeLineContainer DIV 
    as the first child

    <div id             = "appBorderContainer" 
         data-dojo-type = "dijit/layout/BorderContainer" 
         style          = "height:100%; width:100%;">
    
    <div id              = "appCenterPane" 
         data-dojo-type  = "dojox/layout/ContentPane" 
         data-dojo-props = "region:'center',splitter:true">

    </div>
    
    <div id              = "dojoTimeLineContainer" 
         data-dojo-type  = "dojox/layout/ContentPane" 
         data-dojo-props = "region:'bottom',splitter:true"
         style           = 'width:100%; height:20em; margin-bottom:10px;'>
      
    </div>
    -->

  <div id="appContainer">
    <div id="dojoTimeLineWidgetContainer">
    
    </div>

    
    <div id="addEventFormDiv" style="position:relative; top: 20px; margin-top: 20px">
      <form action="{{url_for('add_event')}}"  method = "post" id = "addEventForm">
       <dl> 
       <dt> Title <input type= "text" value = "" name = "title" id= "add_event_title">
       <dd> Desc. <textarea value = "" name = "description" id = "add_event_description rows="20" cols="20"> </textarea>
       <dt> Date  <input type="text" value="" name ="event_date" id="add_event_date">
       <dd> <input type="submit" value="Add Event" id="add_event_form_submit_button">
       </dl>
     </form>
    
    </div>

 </div>
  </body>

</html>
